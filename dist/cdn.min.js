(function(){"use strict";let v=null;function L(n){n.deps&&(n.deps.forEach(e=>{e.delete(n)}),n.deps.clear())}function y(n){const e=()=>{L(e),v=e,n(),v=null};return e.deps=new Set,e(),()=>L(e)}function x(n){let e=n;const r=new Set;return[()=>(v&&(r.add(v),v.deps.add(r)),e),o=>{e=o,new Set(r).forEach(i=>i())}]}const g={};function C(n,e){g[n]=e()}function p(n,e){const r=e.split(".");let a=n;for(const t of r)if(a=a[t],a===void 0)return;return a}function N(n){return n.charAt(0).toUpperCase()+n.slice(1)}const m=new WeakMap;function w(n,e){let r=m.get(n);if(!r)return;const a=r[e];a&&(n.removeEventListener(e,a),delete r[e],Object.keys(r).length===0&&m.delete(n))}function q(n,e){function r(t){if(t==="true")return!0;if(t==="false")return!1;if(t==="null")return null;if(t!=="undefined")return!isNaN(t)&&t.trim()!==""?Number(t):t}return n.map(t=>{const o=p(e,t);return o!==void 0?typeof o=="function"?o():o:r(t)})}function A(n=[],e){n.includes("prevent")&&e.preventDefault(),n.includes("stop")&&e.stopPropagation()}function P(n,e){const r=[];return n.querySelectorAll("[data-text]").forEach(a=>{const t=a.dataset.text,o=y(()=>{const s=p(e,t);a.textContent=typeof s=="function"?s():s});r.push(o)}),n.querySelectorAll("[data-on]").forEach(a=>{const[t,o]=a.dataset.on.split(":"),s=t.split("."),i=s[0],f=s.slice(1),c=a.dataset.param?a.dataset.param.split(",").map(u=>u.trim()):[],d=u=>{const h=p(e,o);if(typeof h=="function"){A(f,u);const S=q(c,e);h(...S,u)}};let l=m.get(a);l||(l={},m.set(a,l)),w(a,i),a.addEventListener(i,d),l[i]=d}),()=>r.forEach(a=>a())}function M(){document.querySelectorAll("[data-scope]").forEach(n=>{const e=g[n.dataset.scope];n.querySelectorAll("[data-text]").forEach(t=>{const o=t.dataset.text,s=p(e,o);y(()=>{t.textContent=s()})}),n.querySelectorAll("[data-on]").forEach(t=>{const[o,s]=t.dataset.on.split(":"),i=o.split("."),f=i[0],c=i.slice(1),d=t.dataset.param?t.dataset.param.split(",").map(h=>h.trim()):[],l=h=>{const S=p(e,s);if(typeof S=="function"){A(c,h);const b=q(d,e);S(...b,h)}};let u=m.get(t);u||(u={},m.set(t,u)),w(t,f),t.addEventListener(f,l),u[f]=l}),n.querySelectorAll("[data-if]").forEach(t=>{const o=t.dataset.if,s=p(e,o);y(()=>{s()?t.style.display="":t.style.display="none"})}),n.querySelectorAll("[data-for]").forEach(t=>{const o=t.querySelector("template"),s=t.dataset.for;let i=[];y(()=>{const f=p(e,s)();i.forEach(c=>c()),i=[],Array.from(t.childNodes).forEach(c=>{c!==o&&c.remove()}),f.forEach((c,d)=>{const l=o.content.cloneNode(!0),u={...e,$item:c,$index:d},h=P(l,u);i.push(h),t.appendChild(l)})})}),n.querySelectorAll("[data-model]").forEach(t=>{const o=t.dataset.model,s=p(e,o),i=p(e,"set"+N(o));y(()=>{const d=s();t.value!==d&&(t.value=d??"")});let f=m.get(t);f||(f={},m.set(t,f));const c=d=>{typeof i=="function"&&i(d.target.value)};w(t,"input"),t.addEventListener("input",c),f.input=c});const a=(n.querySelector("[data-init]")||n).dataset.init;if(a){const t=p(e,a);typeof t=="function"&&t()}})}typeof document<"u"&&document.addEventListener("DOMContentLoaded",M),typeof window<"u"&&(window.signal=x,window.defineScope=C,window.mount=M)})();
