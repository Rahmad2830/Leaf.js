var Leaf=(function(h){"use strict";function u(t,e){const n=e.split(".");let r=t;for(const o of n)if(r=r[o],r===void 0)return;return r}function x(t){return t.charAt(0).toUpperCase()+t.slice(1)}function O(t,e){function n(o){if(o==="true")return!0;if(o==="false")return!1;if(o==="null")return null;if(o!=="undefined")return!isNaN(o)&&o.trim()!==""?Number(o):o}return t.map(o=>{const s=u(e,o);return s!==void 0?typeof s=="function"?s():s:n(o)})}function P(t=[],e){t.includes("prevent")&&e.preventDefault(),t.includes("stop")&&e.stopPropagation()}let k=[];function V(t){t.deps&&(t.deps.forEach(e=>{e.delete(t)}),t.deps.clear())}function m(t){const e=()=>{V(e),k.push(e),t(),k.pop()};return e.deps=new Set,e(),()=>V(e)}function j(t){let e=t;const n=new Set;return[()=>{const s=k[k.length-1];return s&&(n.add(s),s.deps.add(n)),e},s=>{if(Object.is(e,s))return;e=s,new Set(n).forEach(i=>i())}]}function R(t){return e=>{const n=structuredClone(e);return t(n),n}}const B={},A={};function W(t,e){B[t]=e({$stores:A})}function Y(t,e){return A[t]||(A[t]=e()),A[t]}function M(t,e,n){const r=[];return n.forEach(o=>{const s=o(t,e,M,n);typeof s=="function"&&r.push(s)}),Array.from(t.children).forEach(o=>{const s=M(o,e,n);s&&r.push(s)}),()=>r.forEach(o=>o())}function z(t,e){const n=t.dataset.text;return n?m(()=>{const o=u(e,n);t.textContent=typeof o=="function"?o():o}):void 0}const S=new WeakMap;function C(t,e){let n=S.get(t);if(!n)return;const r=n[e];r&&(t.removeEventListener(e,r),delete n[e],Object.keys(n).length===0&&S.delete(t))}function N(t,e,n){let r=S.get(t);r||(r={},S.set(t,r)),C(t,e),t.addEventListener(e,n),r[e]=n}function K(t,e){const n=t.dataset.on;if(!n)return;const[r,o]=n.split(":").map(d=>d.trim()),s=r.split("."),a=s[0],i=s.slice(1),p=t.dataset.param?t.dataset.param.split(",").map(d=>d.trim()):[];return N(t,a,d=>{if(P(i,d),!o)return;const g=u(e,o);if(typeof g=="function"){const E=O(p,e);g(...E,d)}else console.error(`[Listener] ${o} must be a function`)}),()=>C(t,a)}function U(t,e){const n=t.dataset.if;if(!n)return;const r=t.parentNode,o=document.createComment("if");r.insertBefore(o,t),r.removeChild(t);const s=m(()=>{const a=u(e,n);(typeof a=="function"?a():a)?t.isConnected||r.insertBefore(t,o):t.isConnected&&r.removeChild(t)});return()=>{s(),o.isConnected&&o.remove()}}function G(t,e,n,r){const o=new Map,s=[];let a=!1;const i=t.querySelector("template");if(!i)return;const p=t.dataset.for;if(!p)return;const y=t.parentNode,d=document.createComment("for");return y.insertBefore(d,t),y.removeChild(t),m(()=>{const E=u(e,p);E||console.error(`[data-for] ${p} is not found`);const T=typeof E=="function"?E():[],I=t.dataset.key;if(I){s.length&&(s.forEach(f=>{f.el.remove(),f.cleanup&&f.cleanup()}),s.length=0);const c=new Set;let b=d;T.forEach((f,v)=>{const w={$item:f,$index:v,...e},l=u(w,I);if(l==null){console.warn(`Invalid key: ${l}`);return}if(c.has(l))throw new Error(`Duplicate key detected: ${l}. Rendering behavior may be unpredictable.`);c.add(l);const $=o.get(l);if($)$.scope.$item=f,$.scope.$index=v,y.insertBefore($.el,b.nextSibling),b=$.el;else{const L=i.content.cloneNode(!0).firstElementChild,nt=n(L,w,r);o.set(l,{el:L,scope:w,cleanup:nt}),y.insertBefore(L,b.nextSibling),b=L}}),o.forEach((f,v)=>{c.has(v)||(f.el.remove(),f.cleanup&&f.cleanup(),o.delete(v))})}else o.size&&(o.forEach(c=>{c.el.remove(),c.cleanup&&c.cleanup()}),o.clear()),s.forEach(c=>{c.el.remove(),c.cleanup&&c.cleanup()}),s.length=0,a||console.warn(`[data-for="${p}"] does not have a data-key. Reuse DOM may be suboptimal.`),a=!0,T.forEach((c,b)=>{const f={$item:c,$index:b,...e},w=i.content.cloneNode(!0).firstElementChild,l=n(w,f,r);y.insertBefore(w,d),s.push({el:w,scope:f,cleanup:l})})})}function X(t,e){if(t.type==="checkbox"){Array.isArray(e)?t.checked=e.includes(t.value):t.checked=!!e;return}if(t.type==="radio"){t.checked=e===t.value;return}t.value=e??""}function F(t,e){return t.type==="checkbox"?Array.isArray(e())?t.checked?[...e(),t.value]:e().filter(n=>n!==t.value):t.checked:t.type==="radio"?t.checked?t.value:e():t.value}function H(t,e){const n=t.dataset.model;if(!n)return;const r=u(e,n),o=u(e,"set"+x(n));if(typeof r!="function"||typeof o!="function")throw new Error(`[model] "${n}" requires signal "${n}()" and setter "set${x(n)}()"`);const s=m(()=>{X(t,r())}),a=p=>{o(F(t,r))},i=t.tagName==="TEXTAREA"||t.tagName==="INPUT"&&!["checkbox","radio"].includes(t.type);return N(t,i?"input":"change",a),()=>{s(),C(t,i?"input":"change")}}function J(t,e){const n=t.dataset.init;if(!n)return;const r=u(e,n);if(typeof r=="function")r();else throw new Error(`[init] ${n} must be a function`)}function Q(t,e){const n=t.dataset.bind;if(!n||!n.includes(":"))return;const[r,o]=n.split(":").map(i=>i.trim()),s=u(e,o);if(typeof s!="function")throw new Error(`[bind] ${o} is not a signal`);return m(()=>{const i=s();i==null?t.removeAttribute(r):i===!0?t.setAttribute(r,""):i===!1?t.removeAttribute(r):t.setAttribute(r,i)})}function Z(t,e){t.hasAttribute("data-init-hide")&&(t.removeAttribute("data-init-hide"),t.style.display="none");const n=t.dataset.show;if(!n)return;const r=u(e,n);if(typeof r!="function")throw new Error(`[show] ${n} must be a function`);const o=t.hasAttribute("data-animate"),s=t.dataset.animate||"opacity 0.5s ease, transform 0.5s ease";let a=!1;const i=()=>{r()||(t.style.display="none",a=!1)};o&&(t.style.transition=s,N(t,"transitionend",i));const p=m(()=>{if(!o){t.style.display=r()?"":"none";return}r()?(t.style.display="",t.style.opacity="0",t.style.transform="translateY(-10px)",requestAnimationFrame(()=>{t.style.opacity="1",t.style.transform="translateY(0)"})):a||(a=!0,t.style.opacity="0",t.style.transform="translateY(-10px)",t.style.transition=s)});return()=>{p(),o&&C(t,"transitionend")}}function _(t,e){const n=[],r=t.dataset.class;return r?(r.split(",").forEach(s=>{if(!s.trim())return;const[a,...i]=s.split(":");if(a){if(i.length===0)throw new Error("[class] a class is required for adding class")}else throw new Error("[class] a function is required for adding class");const y=i.join(":").trim().replace(/^['"]|['"]$/g,""),d=m(()=>{const g=u(e,a.trim());if(typeof g=="function")y.split(/\s+/).forEach(E=>{E&&t.classList.toggle(E,g())});else throw new Error(`[class] ${a} must be a function`)});n.push(d)}),()=>n.forEach(s=>s())):void 0}const tt=[z,K,U,G,H,J,Q,Z,_],D=new WeakMap;function q(){document.querySelectorAll("[data-scope]").forEach(t=>{const e=B[t.dataset.scope];if(!e)throw new Error(`Scope ${t.dataset.scope} is not defined`);const n=D.get(t);n&&n.forEach(s=>s());const r=[],o=M(t,e,tt);typeof o=="function"&&r.push(o),D.set(t,r)})}function et(t){const e=D.get(t);e&&(e.forEach(n=>n()),D.delete(t))}return typeof document<"u"&&document.addEventListener("DOMContentLoaded",q),h.defineScope=W,h.defineStore=Y,h.effect=m,h.mount=q,h.produce=R,h.signal=j,h.unmount=et,h})({});
