var Leaf=(function(p){"use strict";let l=null;function E(t){t.deps&&(t.deps.forEach(n=>{n.delete(t)}),t.deps.clear())}function m(t){const n=()=>{E(n),l=n,t(),l=null};return n.deps=new Set,n(),()=>E(n)}function C(t){let n=t;const o=new Set;return[()=>(l&&(o.add(l),l.deps.add(o)),n),s=>{if(Object.is(n,s))return;n=s,new Set(o).forEach(a=>a())}]}function N(t){let n;const o=new Set,e=m(()=>{o.forEach(r=>r.deps.delete(e)),o.clear(),n=t(),o.forEach(r=>r())});return{get value(){return l&&(o.add(l),l.deps.add(o)),n}}}const L={},A={};function V(t,n){L[t]=n()}function I(t,n){return A[t]||(A[t]=store()),A[t]}function f(t,n){const o=n.split(".");let e=t;for(const r of o)if(e=e[r],e===void 0)return;return e}function k(t){return t.charAt(0).toUpperCase()+t.slice(1)}function D(t,n){const o=[];return t.querySelectorAll("[data-text]").forEach(e=>{const r=e.dataset.text;if(!r)return;const s=m(()=>{const c=f(n,r);e.textContent=typeof c=="function"?c():c});o.push(s)}),()=>o.forEach(e=>e())}function O(t,n){function o(r){if(r==="true")return!0;if(r==="false")return!1;if(r==="null")return null;if(r!=="undefined")return!isNaN(r)&&r.trim()!==""?Number(r):r}return t.map(r=>{const s=f(n,r);return s!==void 0?typeof s=="function"?s():s:o(r)})}function P(t=[],n){t.includes("prevent")&&n.preventDefault(),t.includes("stop")&&n.stopPropagation()}const y=new WeakMap;function v(t,n){let o=y.get(t);if(!o)return;const e=o[n];e&&(t.removeEventListener(n,e),delete o[n],Object.keys(o).length===0&&y.delete(t))}function g(t,n,o){let e=y.get(t);e||(e={},y.set(t,e)),v(t,n),t.addEventListener(n,o),e[n]=o}function q(t,n){const o=[];return t.querySelectorAll("[data-on]").forEach(e=>{const r=e.dataset.on;if(!r||!r.includes(":"))return;const[s,c]=r.split(":").map(d=>d.trim()),a=s.split("."),i=a[0],u=a.slice(1),h=e.dataset.param?e.dataset.param.split(",").map(d=>d.trim()):[];g(e,i,d=>{if(P(u,d),!c)return;const w=f(n,c);if(typeof w=="function"){const b=O(h,n);w(...b,d)}else throw new Error(`[Listener] ${c} must be a function`)}),o.push(()=>{v(e,i)})}),()=>o.forEach(e=>e())}function W(t,n){const o=[];return t.querySelectorAll("[data-if]").forEach(e=>{const r=e.dataset.if;if(!r)return;const s=m(()=>{const c=f(n,r);(typeof c=="function"?c():c)?e.style.display="":e.style.display="none"});o.push(s)}),()=>o.forEach(e=>e())}function j(t,n){const o=[],e=D(t,n);e&&o.push(e);const r=q(t,n);return r&&o.push(r),()=>o.forEach(s=>s())}function x(t,n){const o=[];return t.querySelectorAll("[data-for]").forEach(e=>{const r=e.querySelector("template");if(!r)return;const s=e.dataset.for;if(!s)return;let c=[];const a=m(()=>{const i=f(n,s),u=typeof i=="function"?i():i||[];c.forEach(h=>h()),c=[],Array.from(e.childNodes).forEach(h=>{h!==r&&h.remove()}),u.forEach((h,$)=>{const d=r.content.cloneNode(!0),w=Array.from(d.children),b={...n,$item:h,$index:$};w.forEach(K=>{const Q=j(K,b);c.push(Q)}),e.appendChild(d)})});o.push(()=>{a(),c.forEach(i=>i()),c=[]})}),()=>o.forEach(e=>e())}function z(t,n){if(t.type==="checkbox"){Array.isArray(n)?t.checked=n.includes(t.value):t.checked=!!n;return}if(t.type==="radio"){t.checked=n===t.value;return}t.value=n??""}function B(t,n){return t.type==="checkbox"?Array.isArray(n())?t.checked?[...n(),t.value]:n().filter(o=>o!==t.value):t.checked:t.type==="radio"?t.checked?t.value:n():t.value}function G(t,n){const o=[];return t.querySelectorAll("[data-model]").forEach(e=>{const r=e.dataset.model;if(!r)return;const s=f(n,r),c=f(n,"set"+k(r));if(typeof s!="function"||typeof c!="function")throw new Error(`[model] "${r}" requires signal "${r}()" and setter "set${k(r)}()"`);const a=m(()=>{z(e,s())}),i=u=>{c(B(e,s))};g(e,"input",i),g(e,"change",i),o.push(()=>{a(),v(e,"input"),v(e,"change")})}),()=>o.forEach(e=>e())}function T(t,n){const e=(t.querySelector("[data-init]")||t).dataset.init;if(e){if(e){const r=f(n,e);if(typeof r=="function")r();else throw new Error(`[init] ${e} must be a function`)}return null}}function U(t,n){const o=[];return t.querySelectorAll("[data-bind]").forEach(e=>{const r=e.dataset.bind;if(!r||!r.includes(":"))return;const[s,c]=e.dataset.bind.split(":").map(u=>u.trim()),a=f(n,c);if(typeof a!="function")throw new Error(`[bind] ${c} is not a signal`);const i=m(()=>{const u=a();u==null?e.removeAttribute(s):u===!0?e.setAttribute(s,""):u===!1?e.removeAttribute(s):e.setAttribute(s,u)});o.push(i)}),()=>o.forEach(e=>e())}const H=[D,q,W,x,G,T,U],S=new WeakMap;function M(){document.querySelectorAll("[data-scope]").forEach(t=>{const n=L[t.dataset.scope];if(!n)throw new Error(`Scope ${t.dataset.scope} is not defined`);const o=S.get(t);o&&o.forEach(r=>r());const e=[];H.forEach(r=>{try{const s=r(t,n);typeof s=="function"&&e.push(s)}catch(s){console.error(`[Directive error] ${r.name}`,s,t)}}),S.set(t,e)})}function J(t){const n=S.get(t);n&&(n.forEach(o=>o()),S.delete(t))}return typeof document<"u"&&document.addEventListener("DOMContentLoaded",M),p.computed=N,p.defineScope=V,p.defineStore=I,p.effect=m,p.mount=M,p.signal=C,p.unmount=J,p})({});
