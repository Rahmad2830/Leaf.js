(function(){"use strict";let l=null;function g(t){t.deps&&(t.deps.forEach(n=>{n.delete(t)}),t.deps.clear())}function h(t){const n=()=>{g(n),l=n,t(),l=null};return n.deps=new Set,n(),()=>g(n)}function M(t){let n=t;const o=new Set;return[()=>(l&&(o.add(l),l.deps.add(o)),n),s=>{n=s,new Set(o).forEach(a=>a())}]}const b={};function $(t,n){b[t]=n()}function f(t,n){const o=n.split(".");let e=t;for(const r of o)if(e=e[r],e===void 0)return;return e}function E(t){return t.charAt(0).toUpperCase()+t.slice(1)}function k(t,n){const o=[];return t.querySelectorAll("[data-text]").forEach(e=>{const r=e.dataset.text;if(!r)return;const s=h(()=>{const i=f(n,r);e.textContent=typeof i=="function"?i():i});o.push(s)}),()=>o.forEach(e=>e())}function x(t,n){function o(r){if(r==="true")return!0;if(r==="false")return!1;if(r==="null")return null;if(r!=="undefined")return!isNaN(r)&&r.trim()!==""?Number(r):r}return t.map(r=>{const s=f(n,r);return s!==void 0?typeof s=="function"?s():s:o(r)})}function C(t=[],n){t.includes("prevent")&&n.preventDefault(),t.includes("stop")&&n.stopPropagation()}const m=new WeakMap;function y(t,n){let o=m.get(t);if(!o)return;const e=o[n];e&&(t.removeEventListener(n,e),delete o[n],Object.keys(o).length===0&&m.delete(t))}function A(t,n,o){let e=m.get(t);e||(e={},m.set(t,e)),y(t,n),t.addEventListener(n,o),e[n]=o}function L(t,n){const o=[];return t.querySelectorAll("[data-on]").forEach(e=>{const r=e.dataset.on;if(!r||!r.includes(":"))return;const[s,i]=r.split(":").map(d=>d.trim()),a=s.split("."),c=a[0],u=a.slice(1),p=e.dataset.param?e.dataset.param.split(",").map(d=>d.trim()):[];A(e,c,d=>{if(C(u,d),!i)return;const v=f(n,i);if(typeof v=="function"){const S=x(p,n);v(...S,d)}else throw new Error(`[Listener] ${i} must be a function`)}),o.push(()=>{y(e,c)})}),()=>o.forEach(e=>e())}function N(t,n){const o=[];return t.querySelectorAll("[data-if]").forEach(e=>{const r=e.dataset.if;if(!r)return;const s=h(()=>{const i=f(n,r);(typeof i=="function"?i():i)?e.style.display="":e.style.display="none"});o.push(s)}),()=>o.forEach(e=>e())}function V(t,n){const o=[],e=k(t,n);e&&o.push(e);const r=L(t,n);return r&&o.push(r),()=>o.forEach(s=>s())}function I(t,n){const o=[];return t.querySelectorAll("[data-for]").forEach(e=>{const r=e.querySelector("template");if(!r)return;const s=e.dataset.for;if(!s)return;let i=[];const a=h(()=>{const c=f(n,s),u=typeof c=="function"?c():c||[];i.forEach(p=>p()),i=[],Array.from(e.childNodes).forEach(p=>{p!==r&&p.remove()}),u.forEach((p,D)=>{const d=r.content.cloneNode(!0),v=Array.from(d.children),S={...n,$item:p,$index:D};v.forEach(U=>{const G=V(U,S);i.push(G)}),e.appendChild(d)})});o.push(()=>{a(),i.forEach(c=>c()),i=[]})}),()=>o.forEach(e=>e())}function O(t,n){if(t.type==="checkbox"){Array.isArray(n)?t.checked=n.includes(t.value):t.checked=!!n;return}if(t.type==="radio"){t.checked=n===t.value;return}t.value=n??""}function P(t,n){return t.type==="checkbox"?Array.isArray(n())?t.checked?[...n(),t.value]:n().filter(o=>o!==t.value):t.checked:t.type==="radio"?t.checked?t.value:n():t.value}function W(t,n){const o=[];return t.querySelectorAll("[data-model]").forEach(e=>{const r=e.dataset.model;if(!r)return;const s=f(n,r),i=f(n,"set"+E(r));if(typeof s!="function"||typeof i!="function")throw new Error(`[model] "${r}" requires signal "${r}()" and setter "set${E(r)}()"`);const a=h(()=>{O(e,s())}),c=u=>{i(P(e,s))};A(e,"input",c),A(e,"change",c),o.push(()=>{a(),y(e,"input"),y(e,"change")})}),()=>o.forEach(e=>e())}function j(t,n){const e=(t.querySelector("[data-init]")||t).dataset.init;if(e){if(e){const r=f(n,e);if(typeof r=="function")r();else throw new Error(`[init] ${e} must be a function`)}return null}}function z(t,n){const o=[];return t.querySelectorAll("[data-bind]").forEach(e=>{const r=e.dataset.bind;if(!r||!r.includes(":"))return;const[s,i]=e.dataset.bind.split(":").map(u=>u.trim()),a=f(n,i);if(typeof a!="function")throw new Error(`[bind] ${i} is not a signal`);const c=h(()=>{const u=a();u==null?e.removeAttribute(s):u===!0?e.setAttribute(s,""):u===!1?e.removeAttribute(s):e.setAttribute(s,u)});o.push(c)}),()=>o.forEach(e=>e())}const B=[k,L,N,I,W,j,z],w=new WeakMap;function q(){document.querySelectorAll("[data-scope]").forEach(t=>{const n=b[t.dataset.scope];if(!n)throw new Error(`Scope ${t.dataset.scope} is not defined`);const o=w.get(t);o&&o.forEach(r=>r());const e=[];B.forEach(r=>{try{const s=r(t,n);typeof s=="function"&&e.push(s)}catch(s){console.error(`[Directive error] ${r.name}`,s,t)}}),w.set(t,e)})}function T(t){const n=w.get(t);n&&(n.forEach(o=>o()),w.delete(t))}typeof document<"u"&&document.addEventListener("DOMContentLoaded",q),typeof window<"u"&&(window.signal=M,window.defineScope=$,window.mount=q,window.unmount=T)})();
